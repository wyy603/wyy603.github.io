# 数学

### 1

找出所有的正整数 $(x,y,z)$，满足 $x< y< z, x+z=2y$ 且 $xyz$ 的最大质因子为 $3$。

**解答：**

引理：对于两个最简分数 $\frac{a}{b},\frac{c}{d}$，若 $\frac{a}{b}+\frac{c}{d}=1$，则 $b=d$。证明：即 $ad+bc=bd$，可得 $d|bc,b|ad$，即 $d|b,b|d$，故 $b=d$。

设 $x=2^{x_1}3^{x_2},y=2^{y_1}3^{y_2},z=2^{z_1}3^{z_2}$，则 $2^{x_1}3^{x_2}+2^{z_1}3^{z_2}=2^{y_1+1}3^{y_2}$，将右式除掉可得 $2^{x_1-(y_1+1)}3^{x_2-y_2}+2^{z_1-(y_1+1)}3^{z_2-y_2}=1$，即两个分数加起来等于 $1$。使用引理，就可知这两个分数只有两种可能：

1. $\frac{2^p}{3^a}+\frac{2^q}{3^a}=1$，即 $2^p+2^q=3^a$。由两边奇偶性，左边要有一个 $1$。对于 $2^p+1=3^a$，一种可能是 $2+1=3$，此外模 $4$ 得 $0+1\equiv (-1)^a\pmod 4$，所以 $2|a$，$2^p+1=3^{2\cdot \frac{a}{2}}$。可以变形为 $2^p=(3^{\frac{a}{2}}+1)(3^{\frac{a}{2}}-1)$，所以 $3^{\frac{a}{2}}+1,3^{\frac{a}{2}}-1$ 都是 $2$ 的幂。唯一一种可能是 $3-1=2,3+1=4$，此时得出的结果是 $8+1=9$。

2. $\frac{3^p}{2^a}+\frac{3^q}{2^a}=1$，即 $3^p+3^q=2^a$。由两边奇偶性，左边要有一个 $1$。对于 $1+3^p=2^a$，$a$ 必须大于 $1$，那么两边模 $3$ 得 $2|a$，变形得 $3^p=(2^{\frac{a}{2}}+1)(2^{\frac{a}{2}}-1)$，所以 $2-1=1,2+1=3$，得出的结果是 $1+3=4$。

综上所述，可能的三个等式是 $2+1=3,8+1=9,1+3=4$，通过它们可以还原所有可能的正整数组。

### 2

考虑两个概率分布：$D_1$ 从 $\{0,1,\cdots,p-1\}$ 中等概率随机一个数，并输出它模 $2^k$ 的值；$D_2$ 从 $\{0,1,\cdots,2^k-1\}$ 中等概率随机一个数。证明这个估计（记号 $x\sim D$ 表示 $x$ 是遵从概率分布 $D$ 的随机变量）

$$ \frac{1}{2}\sum_{z\in \{0,1,\cdots,2^k-1\}} |\Pr_{x\sim D_1} (x=z)-\Pr_{x\sim D_2} (y=z) |\le \frac{2^k}{4p} $$

**解答：** 设 $p=u2^k+v(0\le v< 2^k)$，则 $\Pr_{x\sim D_1} (x=z)=\frac{u+[x< z]}{p}$，所以

$$\text{LHS}=\frac{1}{2}(v\frac{2^k-v}{2^kp}+(2^k-v)\frac{v}{2^kp})=\frac{v(2^k-v)}{2^kp}\le \frac{2^k}{4p}$$

### 3

映射 $f:\N\rightarrow \N$ 满足 $f(n)>f(n-1)$ 和 $f(f(n))=3n$，求 $f(2023)$。

**解答：** 过会写

### 4

考虑 $4\times 4$ 的矩阵，$1\sim 16$ 在其中不重不漏地出现。设 $M_t=\begin{pmatrix}1&2&3&4\\5&6&7&8\\9&10&11&12\\13&14&15&16\end{pmatrix}$

有两种对矩阵的操作：

1. 对于每一列，将这一列中的 $4$ 个元素任意重排，不同列的重排方法可以不同

2. 对于每一行，将这一行中的 $4$ 个元素任意重排，不同列的重排方法可以不同

称 $M$ 是好的，当且仅当 $M$ 的每一行中的 $4$ 个元素模 $4$ 互不相同。

4.1. 每个好矩阵可以通过两次操作变为 $M_t$。

4.2. 每个矩阵可以通过一次操作变为一个好矩阵。（提示：Hall's Marriage Theorem）

**解答：** 4.1. 先做列变换使得每一列的元素模 $4$ 都相同，然后再做行变换。

4.2. 问题转化：每列有 $4$ 个 $0\sim 3$ 的数，每次要从每列中挑一个出来组成一个行，且这行要 $0\sim 3$ 不重不漏。

考虑建二分图，左部点是列，右部点是数，列 $t$ 向数 $k$ 连边当且仅当列 $t$ 中还有数 $k$。我们其实就是要找完美匹配。这个图的每个点的度都是 $n-k$，由 Hall 定理，存在完美匹配。